#cloud-config
system_info:
  default_user:
    name: {{ regular_system_user }}
chpasswd:
  list: |
    root:{{ regular_system_user }}
    {{ regular_system_user }}:{{ regular_system_user }}
  expire: False
ssh_pwauth: True
ssh_authorized_keys:
- {{ ssh_pub_key }}

{% if instance.config_drive.user_data.packages is defined %}
packages:
{% for package in instance.config_drive.user_data.packages %}
  - {{ package }}
{% endfor %}
{% endif %}

{% if instance.config_drive.user_data.runcmd is defined %}
runcmd:
{% for cmd in instance.config_drive.user_data.runcmd %}
  - {{ cmd }}
{% endfor %}
{% endif %}
